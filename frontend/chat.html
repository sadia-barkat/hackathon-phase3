<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Todo AI Chatbot</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #e5ddd5; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        #chat-window { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        .message { max-width: 70%; padding: 10px; border-radius: 10px; margin: 5px; }
        .user { align-self: flex-end; background: #dcf8c6; }
        .assistant { align-self: flex-start; background: white; }
        .input-area { background: white; padding: 20px; display: flex; gap: 10px; }
        input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 20px; outline: none; }
        button { background: #075e54; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; }
    </style>
</head>
<body>
    <div id="chat-window"></div>
    <div class="input-area">
        <input type="text" id="userInput" placeholder="Type a message (e.g., 'Add a task to buy milk')">
        <button onclick="sendMessage()">Send</button>
    </div>

    <script>
        let conversationId = null;
        const USER_ID = "sadia_user"; // Aap apna naam rakh sakti hain

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value;
            if (!message) return;

            // Screen par user ka message dikhao
            appendMessage('user', message);
            input.value = '';

            // Backend ko request bhejo
            const response = await fetch(`http://127.0.0.1:8001/api/${USER_ID}/chat?message=${encodeURIComponent(message)}`, {
             method: 'POST'
             });
            
            const data = await response.json();
            conversationId = data.conversation_id;

            // AI ka jawab dikhao
            appendMessage('assistant', data.response);
        }

        function appendMessage(role, text) {
            const chatWindow = document.getElementById('chat-window');
            const div = document.createElement('div');
            div.className = `message ${role}`;
            div.innerText = text;
            chatWindow.appendChild(div);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }
    </script>
</body>
</html>